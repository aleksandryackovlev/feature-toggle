openapi: 3.0.1
info:
  title: Feature toggle server API
  description: Feature toggle service API spec
  version: v1
servers:
- url: http://localhost:8001/api/v1
tags:
- name: applications
  description: Applications methods
- name: features
  description: Features methods
- name: users
  description: Users methods

paths:
  /applications:
    get:
      tags:
        - applications
      summary: Get all applications
      operationId: getAllApplications
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: limit
          schema:
            type: number
            format: int
        - in: query
          name: offset
          schema:
            type: number
            format: int
        - in: query
          name: search
          schema:
            type: string
        - in: query
          name: createdFrom
          schema:
            type: string
            format: date-time
        - in: query
          name: createdTo
          schema:
            type: string
            format: date-time
        - in: query
          name: updatedFrom
          schema:
            type: string
            format: date-time
        - in: query
          name: updatedTo
          schema:
            type: string
            format: date-time
      responses:
        200:
          description: Successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Application'
        401:
          $ref: '#/components/responses/UnauthorizedError'

    post:
      tags:
        - applications
      summary: Create an application
      operationId: createApplication
      security:
        - bearerAuth: []
      requestBody:
        description: Create application dto
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateApplicationDto'
      responses:
        201:
          description: Created application
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'
        401:
          $ref: '#/components/responses/UnauthorizedError'

  /applications/{appId}:
    get:
      tags:
        - applications
      summary: Get an application
      operationId: getApplication
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: appId
          schema:
            type: string
          required: true
          description: UUID of the application
      responses:
        200:
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'
        401:
          $ref: '#/components/responses/UnauthorizedError'

    put:
      tags:
        - applications
      summary: Update an application
      operationId: updateApplication
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: appId
          schema:
            type: string
          required: true
          description: UUID of the application
      requestBody:
        description: Update application dto
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateApplicationDto'
      responses:
        201:
          description: Updated application
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'
        401:
          $ref: '#/components/responses/UnauthorizedError'

    delete:
      tags:
        - applications
      summary: Delete an application by id
      operationId: deleteApplication
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: appId
          schema:
            type: string
          required: true
          description: UUID of the application
      responses:
        200:
          description: Deleted application
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Application'
        401:
          $ref: '#/components/responses/UnauthorizedError'

  /applications/{appId}/features:
    get:
      tags:
        - features
      summary: Get all features by application id
      operationId: getAllFeatures
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: appId
          schema:
            type: string
          required: true
          description: UUID of the application
        - in: query
          name: limit
          schema:
            type: number
            format: int
        - in: query
          name: offset
          schema:
            type: number
            format: int
        - in: query
          name: search
          schema:
            type: string
        - in: query
          name: createdFrom
          schema:
            type: string
            format: date-time
        - in: query
          name: createdTo
          schema:
            type: string
            format: date-time
        - in: query
          name: updatedFrom
          schema:
            type: string
            format: date-time
        - in: query
          name: updatedTo
          schema:
            type: string
            format: date-time
      responses:
        200:
          description: Successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Feature'
        401:
          $ref: '#/components/responses/UnauthorizedError'

    post:
      tags:
        - features
      summary: Create a feature for the application
      operationId: createFeature
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: appId
          schema:
            type: string
          required: true
          description: UUID of the application
      requestBody:
        description: Create feature dto
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateFeatureDto'
      responses:
        201:
          description: Created feature
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Feature'
        401:
          $ref: '#/components/responses/UnauthorizedError'

  /applications/{appId}/features/{featureId}:
    get:
      tags:
        - features
      summary: Get a feature by application id and feature id
      operationId: getFeature
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: appId
          schema:
            type: string
          required: true
          description: UUID of the application
        - in: path
          name: featureId
          schema:
            type: string
          required: true
          description: ID of the feature
      responses:
        200:
          description: Successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Feature'
        401:
          $ref: '#/components/responses/UnauthorizedError'

    put:
      tags:
        - features
      summary: Update a feature for the application
      operationId: updateFeature
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: appId
          schema:
            type: string
          required: true
          description: UUID of the application
        - in: path
          name: featureId
          schema:
            type: string
          required: true
          description: ID of the feature
      requestBody:
        description: Update feature dto
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateFeatureDto'
      responses:
        201:
          description: Updated feature
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Feature'
        401:
          $ref: '#/components/responses/UnauthorizedError'

    delete:
      tags:
        - features
      summary: Delete a feature by application id and feature id
      operationId: deleteFeature
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: appId
          schema:
            type: string
          required: true
          description: UUID of the application
        - in: path
          name: featureId
          schema:
            type: string
          required: true
          description: ID of the feature
      responses:
        200:
          description: Deleted feature
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Feature'
        401:
          $ref: '#/components/responses/UnauthorizedError'

  /applications/{appId}/features/{featureId}/enable:
    post:
      tags:
        - features
      summary: Enable feature by application id and feature id
      operationId: enableFeature
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: appId
          schema:
            type: string
          required: true
          description: UUID of the application
        - in: path
          name: featureId
          schema:
            type: string
          required: true
          description: ID of the feature
      responses:
        200:
          description: Enabled feature
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Feature'
        401:
          $ref: '#/components/responses/UnauthorizedError'

  /applications/{appId}/features/{featureId}/disable:
    post:
      tags:
        - features
      summary: Disable feature by application id and feature id
      operationId: disableFeature
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: appId
          schema:
            type: string
          required: true
          description: UUID of the application
        - in: path
          name: featureId
          schema:
            type: string
          required: true
          description: ID of the feature
      responses:
        200:
          description: Disabled feature
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Feature'
        401:
          $ref: '#/components/responses/UnauthorizedError'

components:
  schemas:
    Application:
      type: object
      required:
        - id
        - name
        - description
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
        name:
          type: string
        description:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    CreateApplicationDto:
      type: object
      required:
        - name
        - description
      properties:
        name:
          type: string
        description:
          type: string

    UpdateApplicationDto:
      type: object
      properties:
        name:
          type: string
        description:
          type: string

    Feature:
      type: object
      required:
        - id
        - description
        - isEnabled
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
        description:
          type: string
        isEnabled:
          type: boolean
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    CreateFeatureDto:
      type: object
      required:
        - id
        - description
      properties:
        id:
          type: string
        description:
          type: string

    UpdateFeatureDto:
      type: object
      properties:
        description:
          type: string
        isEnabled:
          type: boolean

  responses:
    UnauthorizedError:
      description: Unauthorized access

  securitySchemes:
    bearerAuth: 
      type: http
      scheme: bearer
      bearerFormat: JWT
